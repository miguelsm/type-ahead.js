(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.TypeAhead=f()}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";var hasOwnProperty=Object.prototype.hasOwnProperty;var create=Object.create;var has=function(map,property){return hasOwnProperty.call(map,property)};var createMap=function(){return create(null)};function NodeData(nodeName,key){this.attrs=createMap();this.attrsArr=[];this.newAttrs=createMap();this.key=key;this.keyMap=null;this.keyMapValid=true;this.nodeName=nodeName;this.text=null}var initData=function(node,nodeName,key){var data=new NodeData(nodeName,key);node["__incrementalDOMData"]=data;return data};var getData=function(node){var data=node["__incrementalDOMData"];if(!data){var nodeName=node.nodeName.toLowerCase();var key=null;if(node instanceof Element){key=node.getAttribute("key")}data=initData(node,nodeName,key)}return data};var symbols={default:"__default",placeholder:"__placeholder"};var getNamespace=function(name){if(name.lastIndexOf("xml:",0)===0){return"http://www.w3.org/XML/1998/namespace"}if(name.lastIndexOf("xlink:",0)===0){return"http://www.w3.org/1999/xlink"}};var applyAttr=function(el,name,value){if(value==null){el.removeAttribute(name)}else{var attrNS=getNamespace(name);if(attrNS){el.setAttributeNS(attrNS,name,value)}else{el.setAttribute(name,value)}}};var applyProp=function(el,name,value){el[name]=value};var applyStyle=function(el,name,style){if(typeof style==="string"){el.style.cssText=style}else{el.style.cssText="";var elStyle=el.style;var obj=style;for(var prop in obj){if(has(obj,prop)){elStyle[prop]=obj[prop]}}}};var applyAttributeTyped=function(el,name,value){var type=typeof value;if(type==="object"||type==="function"){applyProp(el,name,value)}else{applyAttr(el,name,value)}};var updateAttribute=function(el,name,value){var data=getData(el);var attrs=data.attrs;if(attrs[name]===value){return}var mutator=attributes[name]||attributes[symbols.default];mutator(el,name,value);attrs[name]=value};var attributes=createMap();attributes[symbols.default]=applyAttributeTyped;attributes[symbols.placeholder]=function(){};attributes["style"]=applyStyle;var getNamespaceForTag=function(tag,parent){if(tag==="svg"){return"http://www.w3.org/2000/svg"}if(getData(parent).nodeName==="foreignObject"){return null}return parent.namespaceURI};var createElement=function(doc,parent,tag,key,statics){var namespace=getNamespaceForTag(tag,parent);var el=undefined;if(namespace){el=doc.createElementNS(namespace,tag)}else{el=doc.createElement(tag)}initData(el,tag,key);if(statics){for(var i=0;i<statics.length;i+=2){updateAttribute(el,statics[i],statics[i+1])}}return el};var createText=function(doc){var node=doc.createTextNode("");initData(node,"#text",null);return node};var createKeyMap=function(el){var map=createMap();var child=el.firstElementChild;while(child){var key=getData(child).key;if(key){map[key]=child}child=child.nextElementSibling}return map};var getKeyMap=function(el){var data=getData(el);if(!data.keyMap){data.keyMap=createKeyMap(el)}return data.keyMap};var getChild=function(parent,key){return key?getKeyMap(parent)[key]:null};var registerChild=function(parent,key,child){getKeyMap(parent)[key]=child};var notifications={nodesCreated:null,nodesDeleted:null};function Context(){this.created=notifications.nodesCreated&&[];this.deleted=notifications.nodesDeleted&&[]}Context.prototype.markCreated=function(node){if(this.created){this.created.push(node)}};Context.prototype.markDeleted=function(node){if(this.deleted){this.deleted.push(node)}};Context.prototype.notifyChanges=function(){if(this.created&&this.created.length>0){notifications.nodesCreated(this.created)}if(this.deleted&&this.deleted.length>0){notifications.nodesDeleted(this.deleted)}};var assertKeyedTagMatches=function(nodeName,tag,key){if(nodeName!==tag){throw new Error('Was expecting node with key "'+key+'" to be a '+tag+", not a "+nodeName+".")}};var context=null;var currentNode=null;var currentParent=null;var root=null;var doc=null;var patchFactory=function(run){var f=function(node,fn,data){var prevContext=context;var prevRoot=root;var prevDoc=doc;var prevCurrentNode=currentNode;var prevCurrentParent=currentParent;var previousInAttributes=false;var previousInSkip=false;context=new Context;root=node;doc=node.ownerDocument;currentParent=node.parentNode;if("production"!=="production"){}run(node,fn,data);if("production"!=="production"){}context.notifyChanges();context=prevContext;root=prevRoot;doc=prevDoc;currentNode=prevCurrentNode;currentParent=prevCurrentParent};return f};var patchInner=patchFactory(function(node,fn,data){currentNode=node;enterNode();fn(data);exitNode();if("production"!=="production"){}});var patchOuter=patchFactory(function(node,fn,data){currentNode={nextSibling:node};fn(data);if("production"!=="production"){}});var matches=function(nodeName,key){var data=getData(currentNode);return nodeName===data.nodeName&&key==data.key};var alignWithDOM=function(nodeName,key,statics){if(currentNode&&matches(nodeName,key)){return}var node=undefined;if(key){node=getChild(currentParent,key);if(node&&"production"!=="production"){assertKeyedTagMatches(getData(node).nodeName,nodeName,key)}}if(!node){if(nodeName==="#text"){node=createText(doc)}else{node=createElement(doc,currentParent,nodeName,key,statics)}if(key){registerChild(currentParent,key,node)}context.markCreated(node)}if(currentNode&&getData(currentNode).key){currentParent.replaceChild(node,currentNode);getData(currentParent).keyMapValid=false}else{currentParent.insertBefore(node,currentNode)}currentNode=node};var clearUnvisitedDOM=function(){var node=currentParent;var data=getData(node);var keyMap=data.keyMap;var keyMapValid=data.keyMapValid;var child=node.lastChild;var key=undefined;if(child===currentNode&&keyMapValid){return}if(data.attrs[symbols.placeholder]&&node!==root){if("production"!=="production"){}return}while(child!==currentNode){node.removeChild(child);context.markDeleted(child);key=getData(child).key;if(key){delete keyMap[key]}child=node.lastChild}if(!keyMapValid){for(key in keyMap){child=keyMap[key];if(child.parentNode!==node){context.markDeleted(child);delete keyMap[key]}}data.keyMapValid=true}};var enterNode=function(){currentParent=currentNode;currentNode=null};var nextNode=function(){if(currentNode){currentNode=currentNode.nextSibling}else{currentNode=currentParent.firstChild}};var exitNode=function(){clearUnvisitedDOM();currentNode=currentParent;currentParent=currentParent.parentNode};var coreElementOpen=function(tag,key,statics){nextNode();alignWithDOM(tag,key,statics);enterNode();return currentParent};var coreElementClose=function(){if("production"!=="production"){}exitNode();return currentNode};var coreText=function(){nextNode();alignWithDOM("#text",null,null);return currentNode};var currentElement=function(){if("production"!=="production"){}return currentParent};var skip=function(){if("production"!=="production"){}currentNode=currentParent.lastChild};var ATTRIBUTES_OFFSET=3;var argsBuilder=[];var elementOpen=function(tag,key,statics,const_args){if("production"!=="production"){}var node=coreElementOpen(tag,key,statics);var data=getData(node);var attrsArr=data.attrsArr;var newAttrs=data.newAttrs;var attrsChanged=false;var i=ATTRIBUTES_OFFSET;var j=0;for(;i<arguments.length;i+=1,j+=1){if(attrsArr[j]!==arguments[i]){attrsChanged=true;break}}for(;i<arguments.length;i+=1,j+=1){attrsArr[j]=arguments[i]}if(j<attrsArr.length){attrsChanged=true;attrsArr.length=j}if(attrsChanged){for(i=ATTRIBUTES_OFFSET;i<arguments.length;i+=2){newAttrs[arguments[i]]=arguments[i+1]}for(var _attr in newAttrs){updateAttribute(node,_attr,newAttrs[_attr]);newAttrs[_attr]=undefined}}return node};var elementOpenStart=function(tag,key,statics){if("production"!=="production"){}argsBuilder[0]=tag;argsBuilder[1]=key;argsBuilder[2]=statics};var attr=function(name,value){if("production"!=="production"){}argsBuilder.push(name,value)};var elementOpenEnd=function(){if("production"!=="production"){}var node=elementOpen.apply(null,argsBuilder);argsBuilder.length=0;return node};var elementClose=function(tag){if("production"!=="production"){}var node=coreElementClose();if("production"!=="production"){}return node};var elementVoid=function(tag,key,statics,const_args){elementOpen.apply(null,arguments);return elementClose(tag)};var elementPlaceholder=function(tag,key,statics,const_args){if("production"!=="production"){}elementOpen.apply(null,arguments);skip();return elementClose(tag)};var text=function(value,const_args){if("production"!=="production"){}var node=coreText();var data=getData(node);if(data.text!==value){data.text=value;var formatted=value;for(var i=1;i<arguments.length;i+=1){var fn=arguments[i];formatted=fn(formatted)}node.data=formatted}return node};exports.patch=patchInner;exports.patchInner=patchInner;exports.patchOuter=patchOuter;exports.currentElement=currentElement;exports.skip=skip;exports.elementVoid=elementVoid;exports.elementOpenStart=elementOpenStart;exports.elementOpenEnd=elementOpenEnd;exports.elementOpen=elementOpen;exports.elementClose=elementClose;exports.elementPlaceholder=elementPlaceholder;exports.text=text;exports.attr=attr;exports.symbols=symbols;exports.attributes=attributes;exports.applyAttr=applyAttr;exports.applyProp=applyProp;exports.notifications=notifications},{}],2:[function(require,module,exports){var IncrementalDOM=require("incremental-dom");var elementClose=IncrementalDOM.elementClose,elementOpen=IncrementalDOM.elementOpen,patch=IncrementalDOM.patch,text=IncrementalDOM.text;var TypeAhead=function(element,candidates,opts){var typeAhead=this;opts=opts||{};typeAhead.element=element;typeAhead.candidates=candidates||[];typeAhead.list=new TypeAheadList(typeAhead);this.minLength=opts.hasOwnProperty("minLength")?opts.minLength:3;typeAhead.limit=opts.hasOwnProperty("limit")?opts.limit:5;typeAhead.onMouseDown=opts.hasOwnProperty("onMouseDown")?opts.onMouseDown:function(){};typeAhead.onKeyDown=opts.hasOwnProperty("onKeyDown")?opts.onKeyDown:function(){};typeAhead.fulltext=opts.hasOwnProperty("fulltext")?opts.fulltext:false;typeAhead.scrollable=opts.hasOwnProperty("scrollable")?opts.scrollable:false;typeAhead.callback=opts.hasOwnProperty("callback")?opts.callback:function(){};typeAhead.query="";typeAhead.selected=null;typeAhead.element.addEventListener("keyup",function(event){typeAhead.handleKeyUp.call(typeAhead,event.keyCode)},false);typeAhead.element.addEventListener("keydown",function(event){typeAhead.handleKeyDown.call(typeAhead,event.keyCode)&&event.preventDefault()});typeAhead.element.addEventListener("focus",function(){typeAhead.handleFocus.call(typeAhead)});typeAhead.element.addEventListener("blur",function(){typeAhead.handleBlur.call(typeAhead)});typeAhead.update=function(candidates){this.candidates=candidates;typeAhead.handleKeyUp.call(typeAhead)};return typeAhead};TypeAhead.prototype.handleKeyUp=function(keyCode){if(keyCode===13||keyCode===38||keyCode===40){return}this.query=this.filter(this.element.value);this.list.clear();if(this.query.length<this.minLength){this.list.draw();return}var typeAhead=this;this.getCandidates(function(candidates){for(var i=0;i<candidates.length;i++){typeAhead.list.add(candidates[i]);if(typeAhead.limit!==false&&i===typeAhead.limit){break}}typeAhead.list.draw()})};TypeAhead.prototype.handleKeyDown=function(keyCode){if(keyCode===13&&!this.list.isEmpty()){this.value(this.list.items[this.list.active]);this.list.hide();this.onKeyDown(this.list.items[this.list.active]);return true}if(keyCode===38){this.list.previous();return true}if(keyCode===40){this.list.next();return true}return false};TypeAhead.prototype.handleBlur=function(){this.list.hide()};TypeAhead.prototype.handleFocus=function(){if(!this.list.isEmpty()){this.list.show()}};TypeAhead.prototype.filter=function(value){value=value.toLowerCase();return value};TypeAhead.prototype.match=function(candidate){var matches,keywords;if(this.fulltext){matches=0;keywords=this.query.split(/\s+/);for(var i=0;i<keywords.length;i++){if(candidate.indexOf(keywords[i])===-1){break}matches++}return matches===keywords.length}return candidate.indexOf(this.query)===0};TypeAhead.prototype.value=function(value){this.selected=value;this.element.value=this.getItemValue(value);if(document.createEvent){var e=document.createEvent("HTMLEvents");e.initEvent("change",true,false);this.element.dispatchEvent(e)}else{this.element.fireEvent("onchange")}this.callback(value)};TypeAhead.prototype.getCandidates=function(callback){var items=[];for(var i=0;i<this.candidates.length;i++){var candidate=this.getItemValue(this.candidates[i]);if(this.match(this.filter(candidate))){items.push(this.candidates[i])}}callback(items)};TypeAhead.prototype.getItemValue=function(item){return item};TypeAhead.prototype.highlight=function(item){var str=this.getItemValue(item);if(!item||!this.query||this.query.length<3){text(str);return}var keywords=this.query.split(/\s+/).filter(function(value,index,self){return self.indexOf(value)===index}).filter(function(kw){return kw.length>1}).map(function(s){return s.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")});str=str.split(new RegExp("("+keywords.join("|")+")","gi"));for(var i=0,l=str.length;i<l;i++){if(i%2===1){elementOpen("strong");text(str[i]);elementClose("strong")}else{text(str[i])}}};var TypeAheadList=function(typeAhead){var typeAheadList=this;typeAheadList.typeAhead=typeAhead;typeAheadList.items=[];typeAheadList.active=0;typeAheadList.element=document.createElement("ul");typeAhead.element.parentNode.insertBefore(typeAheadList.element,typeAhead.element.nextSibling);return typeAheadList};TypeAheadList.prototype.show=function(){this.element.style.display="block"};TypeAheadList.prototype.hide=function(){this.element.style.display="none"};TypeAheadList.prototype.add=function(item){this.items.push(item)};TypeAheadList.prototype.clear=function(){this.items=[];this.active=0};TypeAheadList.prototype.isEmpty=function(){return this.element.children.length===0};TypeAheadList.prototype.draw=function(){var typeAheadList=this;patch(this.element,function(){for(var i=0;i<typeAheadList.items.length;i++){typeAheadList.drawItem(typeAheadList.items[i],typeAheadList.active===i,i)}});if(this.typeAhead.scrollable){this.scroll()}if(this.items.length===0){this.hide()}else{this.show()}};TypeAheadList.prototype.drawItem=function(item,active,index){var className=active?["class","active"]:null;var li=elementOpen.apply(null,["li",index,null].concat(className));elementOpen("a");this.typeAhead.highlight(item);elementClose("a");elementClose("li");var typeAheadList=this;li.onmousedown=function(){typeAheadList.handleMouseDown.call(typeAheadList,item)}};TypeAheadList.prototype.handleMouseDown=function(item){this.typeAhead.value(item);this.typeAhead.onMouseDown(item);this.clear();this.draw()};TypeAheadList.prototype.move=function(index){this.active=index;this.draw()};TypeAheadList.prototype.previous=function(){this.move(this.active===0?this.items.length-1:this.active-1)};TypeAheadList.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)};TypeAheadList.prototype.scroll=function(){if(this.isEmpty()){return}var item=this.element.children[this.active],list=this.element;if(item.offsetTop+item.offsetHeight>=list.scrollTop+list.offsetHeight){list.scrollTop=item.offsetTop+item.offsetHeight-list.offsetHeight;return}if(item.offsetTop<list.scrollTop){list.scrollTop=item.offsetTop}};module.exports=TypeAhead},{"incremental-dom":1}]},{},[2])(2)});